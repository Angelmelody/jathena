--------------------
//0900 by ぴざまん

・アブラカダブラのランダムスキル発動率をabra_db.txtで設定できるように。
・スフィアーマインとバイオプラントの微修正。
・Noreturnマップで蝶が消費だけされるバグ修正。
・一部のアブラ固有スキルが正しく動作しなかったバグ修正。
	(map/)
	mob.c
		mob_damage()、mobskill_use() 修正。
		mob_skillid2skillidx() 追加。
	skill.c
		skill_readdb()、skill_abra_dataset() 修正。
		skill_castend_nodamage_id()、skill_castend_pos2() 修正。
	script.c
		buildin_warp() 修正。

	skill.h 修正。
	map.h 修正。
	(db/)
	abra_db.txt 追加。
	skill_db.txt 修正。
--------------------
//0899 by 胡蝶蘭

・取り巻きMOBの処理修正
	・取り巻き召喚でコアを吐くバグ修正
	・主が別マップに飛ぶと、テレポートで追いかけるように修正
	・取り巻き処理をより軽く変更

	(map/)
	mob.c
		mob_ai_sub_hard_mastersearch()をmob_ai_sub_hard_slavemob()
		に名前を変えて処理修正。
		mob_summonslave()修正

--------------------
//0898 by 胡蝶蘭

・eathenaからCardRemoverNPCの取り込み
	NPCデータも日本語訳してますが、かなり適当です。

	(map/)
	script.c
		buildin_getequipcardcnt(),buildin_successremovecards()
		buildin_failedremovecards()追加
	(conf/sample/)
	npc_card_remover.txt
		カード取り外しNPCの日本語訳
		プロンテラの精錬所の中の左下の部屋にいます

・ポータルで別マップに飛ばしたMOBがそのマップに沸き直すバグ修正
	(map/)
	map.h
		struct mob_dataにmメンバ追加
	mob.c
		mob_spawn(),mob_once_spawn()修正
	npc.c
		npc_parse_mob()修正
	

--------------------
//0897 by ぴざまん

・細かい調整
・ストリップ系とケミカルプロテクション系スキルの全実装
　本鯖での細かい仕様が分ったので実装しました。
　確率は暫定です。

	(map/)
	pc.c
		pc_isequip() 修正
	skill.c
		skill_status_change_start()、skill_castend_nodamage_id() 修正。
		skill_abra_dataset() 修正。
	battle.c
		battle_get_def()、battle_get_atk2() 修正。
		battle_get_vit()、battle_get_int() 修正。
	(db/)
	const.txt 修正。
	skill_db.txt 修正。
	cast_db.txt 修正。

--------------------
//0896 by 胡蝶蘭

・永続的マップ変数機能追加
・マップ変数を文字列型変数としても使用できるようにした
	・今までのプレフィックス $ は永続的になります。
	  一時的マップ変数を使用する場合はプレフィックス $@ を指定してください.

	・永続的/一時的ともに文字列型に対応しています。
	  文字列型のポストフィックスは$です。

	<例> $@hoge 数値型一時マップ変数、$hoge$ 文字列型永続マップ変数
	・永続マップ変数はデフォルトでは save/mapreg.txt に保存されます。
	  これはmap_athena.confのmapreg_txtで設定できます。

・str_dataが再割り当てされるとマップ変数が正常に使用できないバグ修正
	・strdbからnumdbにして、変数名はstr_bufに入れるように。

・map_athena.confのdelnpc,npc:clearが正しく働かないバグ修正

	(map/)
	npc.c
		npc_delsrcfile(),npc_clearsrcfile()修正
	script.c / script.h
		マップ変数系かなり修正
	map.c
		map_read_config()修正など
	(conf/)
	map_athena.conf
		mapreg_txt追加
	(doc/)
	conf_ref.txt
		mapreg_txt,help_txt,motd_txt追加
	script_ref.txt
		文字列型変数の説明修正

--------------------
//0895 by Selena

・mapflagにnozenypenaltyを追加。
　GVGや街中のテロなどで死亡した際に、Zenyペナルティー発生を外す用。

	(map/)
	pc.c
		pc_setrestartvalue() 修正
	script.c
		buildin_setmapflag()、buildin_removemapflag() 修正
	npc.c
		npc_parse_mapflag() 修正
	map.h
		map_data() 修正
	(db/)
	const.txt 修正。

--------------------
//0894 by ぴざまん

・コーマ以外のアブラカダブラ固有スキル全実装。
　オートスペルにはレベルアップ以外多分全部乗せれます。(オートスペルレベルアップは未テスト)
・アブラカダブラ仮実装
　発動スキルがレベル依存じゃありません。
　全ての発動率が理論上均一です。
　アイテムスキルを使って実装しているので一部の使用条件を無視します（ジェム罠気球等）
・アイテムスキルがキャスト・ディレイ無しだったのを修正。

	(map/)
	skill.c
		skill_castend_nodamage_id()、skill_use_id()、skill_use_pos() 修正。
		skill_abra_dataset() 追加。
	(db/)
	skill_db.txt 修正。

--------------------
//0893 by 胡蝶蘭

・他マップからポータルの上にワープしてきたPCがワープしない問題を修正
・チャット中のPCをワープポータルで飛ばすかどうか設定可能に
・MOBをワープポータルで飛ばすかどうか設定可能に
	MOBのワープポータルを許可すると、テロが簡単にできるので注意。

・アカウント変数変更と同時にファイルに書き出すように修正
・マップデータのロード部分のログ表示はあまり重要じゃないと思うので変更。

	(char/)
	inter.c
		mapif_parse_AccReg()でinter_accreg_save()を呼ぶように修正
	(map/)
	mob.c/mob.h
		mob_warp()の引数変更と修正
	battle.c/battle.h
		mob_warp()呼び出しの引数修正
		battle_config関連
	map.c
		map_readallmap(),map_readmap()修正
	pc.c
		pc_setpos()修正
	skill.c
		mob_warp()呼び出しの引数修正
		skill_unit_onplace()修正
	(conf/)
	battle_athena.conf
		chat_warpportal,mob_warpportalの追加
	(doc/)
	conf_ref.txt
		chat_warpportal,mob_warpportalの追加

--------------------
//0892 by 胡蝶蘭

・各種confファイルで別ファイルをインポートできるようにした
	・自分のサーバー用の設定を別ファイルに記述できるようになります。
	・全て「import: ファイル名」形式で記述します。
	・各種confファイル（login,char,map,inter,atcommand,battle）の最後に
	  conf/import/*_conf を読むように指定したので、そこに自分用の設定を
	  書いておけば、変更部分のみオーバーライドします。
	  msg,scriptのconfについては、この限りではありませんが、import命令の
	  処理は追加されているので、自分でimport命令を書けば動きます。
	・新しいスナップショットが出た場合などに、このconf/importフォルダを
	  昔のAthenaからコピーするだけで自分用の設定を適用できるようになります.

・map_athena.confのmapとnpcで追加したファイルを削除できるようにした
	・上に関連する変更です。
	・delmap,delnpc命令を使用すれば、map,npc命令で追加したファイルを
	  読み込まないように指定できます。ここでファイル名ではなく、
	  all と指定するとそれまでに指定されたファイルを全て読み込まなくします.
	・map,npc命令で、ファイル名にclearを指定すると、
	  delmap,delnpcのallと同等の動作をするようになりました。

・login_athena.confのallowとdenyをクリアできるようにｓた
	・allowおよびdeny命令でclearを指定すると以前のホスト情報を全削除します.

	(conf/)
	各種confファイルの最後にimport命令追加
	(conf/import)
	*.txt
		インポートされるファイル。これらに自分用の設定を書くとよい。
	(login/)
	login.c
		login_read_config()修正
	(char/)
	char.c/inter.c
		char_read_config(),inter_read_config()修正
	(map/)
	map.c
		map_read_config(),map_addmap()修正、map_delmap()追加
	npc.c
		npc_addsrcfile()修正,npc_delsrcfile(),npc_clearsrcfile()追加
	battle.c/atcommand.c/script.c
		battle_read_config(),atcommand_read_config(),
		msg_read_config(),script_read_config()修正
	(doc/)
	conf_ref.txt
		修正

--------------------
//0891 by (凸)

・「スキル使用の後は、しばらくお待ちください」を表示するかどうか設定できるようにした。
    ・本鯖相違スレッド　其のⅡ>>5さんのコードをパクリました。
	(doc/)
	conf_ref.txt 修正。
	(conf/)
	battle_athena.conf 修正。
	(map/)
	battle.h 修正。
	battle.c
		battle_config_read() 修正。
	clif.c
		clif_skill_fail() 修正。

--------------------
//0890 by 死神

・ギルド倉庫を一度に一人だけが使用するように変更。(未テスト)
・battle_athena.confからplayer_undead_nofreeze 削除。
・@コマンド@gstorage 追加。
・スクリプトguildstorageをguildopenstorageに変更。
・その他細かいバグ修正。
	(doc/)
	conf_ref.txt 修正。
	script_ref.txt 修正。
	(conf/)
	atcommand_athena.conf 修正。
	battle_athena.conf 修正。
	help.txt 修正。
	(conf/sample/)
	gstorage_test.txt 追加。
	(char/)
	makefile 修正。
	int_storage.h 修正。
	int_storage.c
		inter_storage_delete()、inter_guild_storage_delete() 追加。
	int_guild.c
		guild_check_empty()、mapif_parse_BreakGuild() 修正。
	(map/)
	makefile 修正。
	battle.h 修正。
	battle.c
		battle_config_read() 修正。
	guild.c
		guild_broken() 修正。
	storage.h 修正。
	storage.c
		storage_guild_storageopen() 修正。
		storage_delete()、guild_storage_delete() 追加。
	script.c
		buildin_guildstorage() を buildin_guildopenstorage()に変更。
	intif.c
		intif_parse_LoadGuildStorage() 修正。
	mob.c
		mob_summonslave()、mob_damage()、mob_delete() 修正。
		mob_catch_delete()、mob_readdb() 修正。
	skill.c
		skill_castend_nodamage_id()、skill_status_change_start() 修正。
	clif.c
		clif_parse_ActionRequest() 修正。
	atcommand.h 修正。
	atcommand.c
		atcommand() 修正。

--------------------
//0889 by 胡蝶蘭

・文字列型一時的キャラクター変数機能追加。
	・プレフィックス@,ポストフィックス$を使用します。（@hoge$など）
	・inputで文字列変数を指定すると文字列入力になります。
	・関係演算子（比較演算子）で文字列どうしを指定すると文字列の比較が
	  できます。数値と文字列を混ぜて比較することはできません。
	・とりあえずサンプル付けてます。

	(map/)
	map.h
		struct map_session_dataにnpc_str,regstr,regstr_numメンバ追加
	script.c
		buildin_set(),get_val(),buildin_input(),op_2num()など修正
		op_2str(),op_2()追加
	clif.c / clif.h
		01d5パケット長修正
		clif_parse_NpcStringInput(),clif_scriptinputstr()追加
	pc.c / pc.h
		pc_readregstr(),pc_setregstr()追加
	(doc/)
	script_ref.txt
		演算子の説明追加、変数の説明修正、input,menu修正
	(conf/sample/)
	npc_test_str.txt
		文字列変数を使用したスクリプトの例。
		文字列の代入、結合、比較、入力などのテストを行うもの。

--------------------
//0888 by 死神

・設計から間違っていたギルド倉庫修正。(ただ複数人の使用によるバグがある可能性はまだあります。)
・細かいバグ修正。
	(doc/)
	inter_server_packet.txt 修正。
	conf_ref.txt 修正。
	(conf/)
	inter_athena.conf 修正。
	help.txt 修正。
	(common/)
	mmo.h 修正。
	(char/)
	makefile 修正。
	int_storage.h 修正。
	int_storage.c
		account2storage()、inter_storage_init()、storage_fromstr() 修正。
		inter_storage_save()、mapif_load_storage() 修正。
		mapif_parse_SaveStorage() 修正。
		guild_storage_fromstr()、guild_storage_tostr() 追加。
		inter_storage_save_sub()、inter_guild_storage_save_sub() 追加。
		inter_guild_storage_save()、mapif_parse_LoadGuildStorage() 追加。
		mapif_parse_SaveGuildStorage()、mapif_load_guild_storage() 追加。
		mapif_save_guild_storage_ack()、guild2storage() 追加。
	int_party.c
		inter_party_init() 修正。
	int_guild.h 修正。
	int_guild.c
		inter_guild_init() 修正。
		inter_guild_search() 追加。
	int_pet.c
		inter_pet_init() 修正。
	inter.c
		inter_init()、inter_save()、inter_config_read() 修正。
	(map/)
	makefile 修正。
	map.h 修正。
	map.c
		map_quit()、do_init() 修正。
	pc.c
		pc_setpos() 修正。
	storage.h 修正。
	storage.c
		do_init_storage()、do_final_storage()、account2storage() 修正。
		storage_storageopen()、storage_storageadd()、storage_storageget() 修正。
		storage_storageaddfromcart()、storage_storagegettocart() 修正。
		storage_storageclose()、storage_storage_quit() 修正。
		storage_storage_save() 修正。
		guild2storage()、storage_guild_storageopen() 追加。
		guild_storage_additem() 、guild_storage_delitem() 追加。
		storage_guild_storageadd()、storage_guild_storageget() 追加。
		storage_guild_storageaddfromcart()、storage_guild_storagegettocart() 追加。
		storage_guild_storageclose()、storage_guild_storage_quit() 追加。
	intif.h 修正。
	intif.c
		intif_send_storage()、intif_parse_LoadStorage()、intif_parse() 修正。
		intif_request_guild_storage()、intif_send_guild_storage() 追加。
		intif_parse_SaveGuildStorage()、intif_parse_LoadGuildStorage() 追加。
	clif.h 修正。
	clif.c
		clif_additem()、clif_parse_MoveToKafra() 修正。
		clif_parse_MoveFromKafra()、clif_parse_MoveToKafraFromCart() 修正。
		clif_parse_MoveFromKafraToCart()、clif_parse_CloseKafra() 修正。
		clif_parse_LoadEndAck() 修正。
		clif_guildstorageitemlist()、clif_guildstorageequiplist() 追加。
		clif_updateguildstorageamount()、clif_guildstorageitemadded() 追加。
	guild.c
		guild_broken() 修正。
	script.c
		buildin_openstorage()、buildin_guildstorage() 修正。
	skill.c
		skill_castend_nodamage_id() 修正。
	mob.c
		mob_summonslave()、mob_damage() 修正。
	atcommand.c
		atkillmonster_sub()、atcommand() 修正。

--------------------
//0887 by 獅子o^.^o

・(db/)
	skill_tree.txt 修正

--------------------
//0886 by ぴざまん

・サーバーsnapshot
・ファイル調整

--------------------

//0885以前の変更点はReadmeを参照してください

--------------------

    Athena Dev. v2.1.1       Released: Middle July, 2003
    (c) 2003 Athena Project.
     http://project-yare.de/

1. Athena(アテナ)について
2. このリリースについて
3. 必要な物
4. 使い方
5. 現在の仕様
6. 祝辞
7. 免責事項
8. 募集
9. English


1. アテナについて
    アテナとは2003年1月半ばにでた0052.lzhをベースとして作られているエミュレータの一つです。
    基本的なライセンスはオリジナルがGPLの下に配布されている為、
    これに従いGPLの下配布を許可します。
    /*
        改良版を配布する場合は必ずこのREADMEを書き換えてください。
        何処を改良したのか報告(athena@project-yare.deまで)して貰えると助かります。
        バイナリのみの配布はGPL違反ですので"必ず"ソースも添付してください。
     */
    動作の確認は以下の通りのみ行っています。
    // ただし完璧に動く事を保証するものでありません
    対象CPU: Intel Pentium系   // PentiumII以上で確認.
        FreeBSD 4.8R, 4.6.2R
        Linux RedHat 7.3
        cygwin + gcc 3.2 20020927 (prerelease)
    開発元URL: http://project-yare.de/


2. このリリースについて
    今回のリリースは前回(V2.1)同様開発版のリリースのみです。
    2.1に比べ下記の点が修正されています。
        mapのデフォルト設定が韓国data.grfのみ正常に動作するようになっていた点
        common/timer.cやmap/script.cの幾つかのバグ

    迅速にUpdateを強く推奨するものではありませんが各自の判断で行って下さい。


3. 必要な物
    data.grf      //sdata.grfは必要に応じて
    account.txt   //存在しない場合athena.shが自動生成します
    conf/*.cnf    //Map用とChar用の二種類あります
    conf/npc*.txt //npc設定用ファイルです。複数のファイルに分けることが可能です。
    db/*.txt      //アイテム、job情報など


4. 使い方
    > tar xvfz athena-d?.?.tar.gz
    > cd athena-d?.?.tar.gz
    > make
    > vi conf/char_athena.cnf       //IP(127.0.0.1)の部分を環境に合わせて変更してください
    > vi conf/map_athena.cnf        //同上、またmap設定などは、このファイルで行います。
    > ./athena.sh
    上記を行えば"たぶん"起動します。

    補足:
    conf/npc_sampleJ.txtにはスクリプトの書き方について色々な説明が記載されています。
    もし、独自のMap設定を行ってみたい人や、スクリプトを弄りたい方は参考にしてください。
    ただし、開発中のためスクリプトの仕様が変更される可能性が高いです。
    command.txtには実装済みの特殊コマンドについての説明を記載しています。


5. 現在の仕様
    本鯖と比べておかしい(例えばプバが歩く、ポリンがアイテムを拾わないなど)点は、
    全て現在開発中に因るものです。
    現状としてキャラクタ系及びモンスター系のバグ報告は無視される可能性が高いです。

    バグ報告について必ず発生条件をお書き下さい。
    下にある報告用テンプレートを使って報告して頂くと助かります。
    報告先はエミュ板の開発スレにでも。
    ---- Athena v 2.0 (stable or develop) ----
    【gcc ver】gcc -vを実行時に表示される内容
    【動作システム】FreeBSD, Linux(ディストリビュージョンも), cygwinなど
    【発生内容】mapが落ちてしまった時の表示されていたデバッグ情報など具体的に書いてください。
    【操作内容】具体的にどんな操作を行ったかを書いてください。
    ------------------ END -------------------
    理想はテンプレに加えてmap.coreなどcoreファイルをUploaderにアップして頂くことですが
    問題のMapだけの状態にしcoreの吐く容量に注意してください。
    /*
        確認した限りでは324個ほどmapデータを読み込ませると、
         40MB近いcoreファイルを吐き出します @FreeBSD
         cygwinの場合はstackdumpというファイルになるそうです。
        しかし、coreファイルなどをgzip圧縮などすれば大幅に小さくなります。
         大凡30MBのcoreファイルが2.9MBほどになるようです。
        ですので、もしアップロードする場合はgzip圧縮など各自行ってください。
     */

    今回のリリースだけでなくHISTORYを作成すると大量に記述が必要な為省略しています。
    // 多い日だと本当に結構ありますので‥‥。


6. 祝辞
    今回このAthena開発版を出すに当たって感謝したい方々(順番不同)
        Lemming氏 (Project YARE)
        0052氏 (Uploader)
        35氏 (エミュ開発スレ)
        Johan Lindh氏(Author of memwatch)
        YARE forumのNPC情報を作成した方々
        weiss研究会BBSの様々な情報ファイルを作成した方々
        最後に、.coreファイル達


7. 免責事項
    Athena Projectは一切Athenaの動作に関する保証等は行いません。
    つまり、Athenaは無保証です。
    athena@project-yare.deに動作・操作等に関する質問などを送られても一切お答えできません。
    又Athenaを用いたことにより生じた被害・問題等の責任は一切Athena Projectは負いません。


8. 募集
    athenaの開発に参加したい//興味があるという方ご連絡下さい。
    我々は貴方の参加をお待ちしています。
    // 最新版が欲しいだけで何ら協力して頂けないという方はお断りです;-)
    [募集要項: プログラマ(2-3人)]
        年齢: 不問
        性別: 不問
        言語: 日本語が理解可能
        内容: C言語もしくはC++による開発。(特にネットワークやDBの経験が有る方大募集!)
    [募集要項: 翻訳(?人)]
        年齢: 不問
        性別: 不問
        言語: 日本語、英語が理解可能
        内容: 仏蘭西語、独逸語、西班牙語、伊太利亜語、泰(タイ)語、朝鮮語、中国語へ文献、サイトなどの翻訳
    連絡先: athena@project-yare.de 雑務担当まで。


9. English
     This release is just fixed some bugs in timer.c, script.c and map_athena1.conf.


(c) 2003 Athena Project.

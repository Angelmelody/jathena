--------------------
//1037 by 胡蝶蘭

** FOR ENGLISH DEVELOPERS **
DO NOT UPLOAD IF YOU DON'T USE JAPANESE ENCODE (SHIFT-JIS) !
WHY WE(JAPANESE) REPAIR ERROR CHARACTER AFTER EVERY YOUR UPLOADING ?
BREAKING IS EASY, REPAIRING IS VERY DIFFICULT !

** 英語圏の開発者の方へ(日本語訳) **
日本語エンコード(シフトJIS)を使う気が無いならアップロードしないてください！
なぜ我々（日本人）があなた方のアップロードのたびに文字化けを直さなければならないんですか？
壊すのは簡単ですが、直すのはとても難しいんです！

・文字化けを根性で修正
	(map/)
	script.c

・ladminがPOSIX必須に。Digest::MD5が無くても実行できるように修正
・serverstatus.cgiで、Net::Pingが無くても実行できるように修正
	(bin/tool/)
	ladmin
	(bin/tool/cgi/)
	serverstatus.cgi

・script_refで抜けてるものでわかるものを修正
	何故かscript_refから抜けてるもの(getargなど)の一部を再び追加
	** アップロードするときは最新パッチからの差分をアップロードしましょう **
	(doc/)
	script_ref.txt

・account_making.txt修正
	ladminスクリプトのパス
	(doc/)
	accoun_tmaking.txt

--------------------
//1036 by Michael
・追加 Script Command:
  getequipid(EquipPos);		EquipPos: 1-10
  gettimetick(Type);		Type: 0 SystemTick, 1 TimeSecondTick(0-86399)
  gettime(Type);		Type: 1 Sec, 2 Min, 3 Hour, 4 Weekday, 5, Monthday, 6 Month, 7 Year
  gettimestr("TimeFMT", Len);	TimeFMT: Time format strinf / Len: String Length
 
	(map/)
	script.c
		buildin_getequipid(); 追加
		buildin_gettimetick(); 追加
		buildin_gettime(); 追加
		buildin_gettimestr(); 追加

--------------------
//1035 by Michael
・追加 GVG Script NPC edit from Aegis NPC(Chinese-big5 version), Please someone translate to Japanese.
・修正 NPC Script Command - buildin_getgdskilllv()
  getgdskilllv(Guild_ID, Skill_ID);
 
	(map/)
	script.c
		buildin_getgdskilllv() 修正

--------------------
//1034 by (Pepermint)
	FIX NPC Script Command - buildin_getgdskilllv()
        Add NPC Sctipt Command - buildin_agitcheck()
	(map/)
	script.c
		buildin_getgdskilllv() 修正
		buildin_agitcheck() 追加

--------------------
//1033 by Michael
・追加 NPC Script Command - buildin_getgdskilllv()
  getgdskilllv(Guild_ID, Skill_ID);
  skill_id = 1:GD_APPROVAL,2:GD_KAFRACONTACT,3:GD_GUARDIANRESEARCH,4:GD_CHARISMA,5:GD_EXTENSION
 
	(map/)
	script.c
		buildin_getgdskilllv() 追加

--------------------
//1032 by (凸)
・1031で何故か削除されていたbuildin_getitemname()を復活
・バグスレなどに出た修正を反映
・その他細かい修正

	(map/)
	clif.c
		clif_disp_onlyself() NULLチェック追加
	map.c
		map_nick2sd() nickがNULLだとすぐNULLを返すように変更
	mob.c
		mob_setdelayspawn() NULLチェック変更
		mob_delete() 修正
	npc.c
		npc_parse_warp() 修正
	script.c
		buildin_getitemname() 復活

--------------------
//1031 by huge
・NPCのscriptに、makepetを追加。
    makepet 卵ID; で、ペットを作成します。
・NPCのscriptに、getexpを追加。
    getexp Base,Job; で、それぞれの経験値を増やします。
・ペットの卵をNPCのdelitemで消したりshopで売った時、ペットセーブデータから削除するよう修正。
・ディボーション成功条件修正。(未確認)
・経験値表示を可能にしてみました。confにて設定してください。

	(conf/)
	battle_athena.conf 修正
	(doc/)
	conf_ref.txt 修正
	script_ref.txt 修正
	(map/)
	battle.c
	battle.h
		disp_experience 追加
	clif.c
	clif.h
		clif_disp_onlyself() 追加
	pc.c
		pc_gainexp() 修正
	script.c
		buildin_delitem() 修正
		buildin_makepet() 追加
		buildin_getexp() 追加
	npc.c
		#include 修正
		npc_selllist() 修正
	skill.c
		skill_castend_nodamage_id() 修正


--------------------
//1030 by (凸)
・map_athena.confに新婚島ザワイをコメントアウトして追加
・クローンスキルで覚えたスキルを自動セーブごとに忘れていたのでとりあえずログオフ時にのみ忘れるように変更したつもり
・mobskill_castend_posの無害nullpoチェックを変更
・Emotionの設定がないMobがスキルを使用するときに/!を出していたのを修正
・バグスレに投げたtrade.cを添付。とりあえず相手が所持できる種類の限界を超えた場合は渡さずに元に戻すように変更

	(conf/)
	map_athena.conf ザワイ追加
	(doc/)
	client_packet.txt パケット長の更新
	(map/)
	map.c
		map_quit() 終了時にクローンスキルで覚えたスキルを忘れるように変更
	mob.c
		mobskill_castend_pos() nullpoチェック変更
		mob_readskilldb() 修正
	pc.c
		pc_makesavestatus() クローンスキルを忘れるのをmap_quitに任せた
	trade.c
		trade_tradecommit() 所持できる種類以上を取引した場合にアイテムが消えないように

--------------------
//1029 by (凸)
・20040619RagexeHC_jp.rgzの0x204と0x20bパケットに対応
・charとloginも知らないパケットが来たらパケットダンプを出力するようにclif.cからコピペ

	(doc/)
	client_packet.txt 新パケット追加
	(char/)
	char.c
		parse_char() 0x20b対応
	(login/)
	login.c
		parse_login() 0x204対応

--------------------
//1028 by (凸)
・ウンバラ以降、Mobがスキルを使用するときにエモーションを出すようになったので、mob_skill_dbを拡張
	サンプルでオークウォーリアーが喫煙すると「/…」を出すのとオークレディが速度を使うと「/ちゅ」を出します
・アイテム682,683を使用すると30秒間ATKやMATKが増えるらしいのでそれっぽく
・job_db2.txtに謎の行が2行あったのを削除
・範囲魔法などでスキルユニット相手にステータス変更をかけようとした場合にnullpoが出たのを修正

	(db/)
	const.txt SC_INCATK SC_INCMATK追加
	item_db.txt ↑を682,683に追加
	job_db2.txt 謎の2行を削除
	mob_skill_db.txt Emotion追加
	(map/)
	mob.c
		mobskill_use() スキル使用時にエモーションを出すように変更
		mob_readskilldb() Emotionを読み込むように変更
	mob.h 変更
	pc.c
		pc_calcstatus() 変更
	skill.c
		
		skill_status_change_end() 変更
		skill_status_change_start() 変更とNULLチェック修正
	skill.h 変更
	
--------------------
//1027 by Ni+S
・getitemname関数追加
・スクリプトにgetitemname関数を追加
・itemidより、jnameを文字列で返します
・詳しくはscript_ref.txtで。

	script.c
		getitemname()追加

--------------------
//1026 by (凸)
・1023で入れてなかったclif.hを同梱
・バイオプラントとスフィアーマインで出したmobを倒すとmob_timer_delete()でnullpoが出る問題を解決したつもり
・バグ報告スレッド part6 >>63 Destさんのscript.c修正を取り込み

	(map/)
	clif.h 変更
	map.h 変更
	mob.c
		mob_changestate() 変更
	skill.c
		skill_castend_pos2() 変更
		mob_spawn() 変更
		do_init_mob() add_timer_func_listにmob_timer_deleteが無かったので追加してみた
	script.c
		script_load_mapreg() 変更

------------------------
//1025 by Sel
・ロードナイトのジョブ補正が間違っていたのを修正
・オーラブレード効果時間を修正
・オーラブレード武器制限を素手以外全てに修正
・コンセントレーション武器制限を両手槍のみから片手槍+両手槍へ修正
・トゥルーサイト効果時間を修正

	(db/)
	job_db2-2.txt 変更
	skill_cast_db.txt 変更
	skill_require_db.txt 変更
--------------------
//1024 by mare
・ファーマシー材料の変更、製造可能薬品の追加
	6/8日本鯖にきたものと同じにしました

	(db/)
	produce_db.txt 変更

--------------------
//1023 by (凸)
・1022でエンバグしたnpc_parse_script()を戻し
・スパイラルピアースの重量追加ダメージ計算式をちょっと変更
・魔法力増幅の計算式をちょっと変更
・テンションリラックスが座って使うのではなく使うと座るという情報を見かけたので変更
・↑に伴いskill_requireのsitting条件廃止
・バーサークをGvGで使用できないように変更

	(db/)
	skill_cast_db.txt 変更
	skill_require_db.txt 変更
	(doc/)
	db_ref.txt 修正
	(map/)
	battle.c
		battle_calc_pc_weapon_attack() 変更
	clif.c
		clif_sitting() 追加
		clif_parse_ActionRequest() 変更
	npc.c
		npc_parse_script() 修正
	pc.h 変更
	pc.c
		pc_calcstatus() 変更
		pc_natural_heal_hp() 変更
		pc_setstand() 追加
	skill.c
		skill_castend_nodamage_id() テンションリラックスを使うと座るように
		skill_check_condition() ST_SITTING廃止
		skill_use_id() バーサークをGvGで使用できないように
		skill_status_change_timer() テンションリラックスは10秒ごとにSPを12消費
		skill_status_change_start() テンションリラックス変更
		skill_readdb() sitting廃止
	skill.h 変更

--------------------
//1022 by (凸)
・NULLチェック変更
・login,char,map終了時に開放されていなかったメモリを微妙に開放する努力をしてみた
・スパノビ爆裂波動実装、クリティカル+50
・スパノビボーナスを変更、最初から一度も死んでないJobLv70にAll+15、BaseLv99にMHP+2000

	(doc/)
	client_packet.txt S 01ed追加
	(char/)
	do_final() 変更
	do_init() 変更
	(login/)
	do_final() 追加
	do_init() 変更
	(map/)
	atcommand.c Destさんの変更を取り込み
	battle.c 同上
	chat.c NULLチェック変更
	chrif.c NULLチェック変更
	clif.c NULLチェック変更
		clif_parse() 変更
		clif_parse_sn_explosionspirits() 追加
		clif_parse_sn_doridori() 名前変更
	guild.c NULLチェック変更
	intif.c NULLチェック変更
	itemdb.c NULLチェック変更
	map.c NULLチェック変更
		do_final() 変更
	mob.c NULLチェック変更
	npc.c NULLチェック変更
		npc_parse_script() buf開放忘れ？を開放
	party.c NULLチェック変更
	path.c NULLチェック変更
	pc.c NULLチェック変更
		pc_calcstatus() スパノビ変更
	pet.c NULLチェック変更
	storage.c NULLチェック変更
	trade.c NULLチェック変更
	vending.c NULLチェック変更

--------------------
//1021 by Kalen
・プロンテラ冠婚品NPCにてタキシード販売
・Umbalaのワープ見直し
	D2Fのワープを本鯖使用に変更。重複ポイント修正
・UmbalaNPC修正
	ラベルを使用しなくいい場所は極力削除(-)
	セーブポイント修正
	バンジージャンプ台追加
	骸骨門追加
	分解、合成処理追加
	カプラ、案内要員をあるべき場所へ移動。
	 ※一部Emoについて、癌呆自身が逆に取り違えているみたいなので独自で変えました。
	 見てもらえば分かりますが18と28を逆にするとNPCの会話内容に合うEmoが出たので
	クエストフラグの条件追加
	　これによりすでに終えている場合でも途中になる可能性があります。
・スパノビ転職NPC追加
	凸さんのログを基に作成しました。
・アルケミストギルドのノビの場合の対応修正(凸さんからのログより)
・結婚NPC追加
	ただし、まだテスト段階です。問題点があるため結婚不可能です。
	(/script)
	 (/warp)
	  npc_warp_umbala.txt
	 (/npc)
	  (/town)
	   npc_town_umbala.txt
	   npc_town_kafra.txt
	   npc_town_guide.txt
	   npc_town_prontera.txt
	  (/quest)
	   npc_event_marriage.txt(新・テスト)
	  (/job)
	   npc_job_alchemist.txt
	   npc_job_supernovice.txt(新)

--------------------
//1020 by (凸)
・nullpoの変更に対応してmap_athena.confの設定削除＆skill.c書き換え
・座っているとHPRとSPRが通常の半分で発動したのを修正
・スパノビが一定条件(クライアント依存)で/doridoriするとSPR回復量が倍になるように変更
・結婚式用のエフェクトをスクリプトからwedding命令で発生させることが出来るようした
・合奏を開始したPCは合奏中に終了できないようにしたつもり(未確認)

	(conf/)
	map_athena.conf nullpo_check削除
	(doc/)
	client_packet.txt 更新
	conf_ref.txt nullpo_check削除
	(map/)
	map.c
		map_config_read() nullpo_check削除
	map.h 同上
	skill.c NULLチェック再度総入れ替え
	clif.c
		clif_wedding_effect() 追加
		clif_parse_QuitGame() 合奏開始者は合奏中に終了できないように変更
		clif_parse_doridori() 追加
		clif_parse() doridori追加
	clif.h 変更
	pc.c
		pc_authok() doridori初期化追加
		pc_natural_heal_hp() 座っているときのHPR時間修正
		pc_natural_heal_sp() 座っているときのHPR時間修正、doridori追加
	script.c
		buildin_wedding_effect() 追加


--------------------
//1019 by Dest
・nullpoモジュールにコーディングミス発見/修正
・同、voidな関数から呼ばれた時のnullpo_retv_f()を追加
・同、条件コンパイルに対応

	(common/)
	nullpo.c
		nullpo_info_core() コーディングミス修正
	nullpo.h
		NULLPO_CHECKフラグによる条件コンパイル追加
		nullpo_retv_f() 追加

--------------------
//1018 by chloe
・ウンバラモンスターを追加

	(script/mob/)
		npc_monster.txt 変更
			各ウンバラマップにMob配置
	(db/)
		mob_db.txt 変更
			1495,STONE_SHOOTER,フレイムシューター 修正
			1511,AMON_RA,アモンラー 修正

--------------------
//1017 by (凸)
・バグ報告スレッド part6 >>46 Destさんのnullpoモジュールを追加＆voidな関数から呼ばれた時のnullpo_retv()を追加(とりあえずskill.cのNULLチェックだけ入れ替え)
・同>>39 Selさんから報告があったコンセントレーションを修正
・仕様について語り合うスレッド >>33 Kalenさんの情報をclient_packet.txtに反映
・本鯖相違スレッド part3 >>24 M ＠zqcM6jBwさんの情報を↑
・同>>30 はちさんの修正を反映

	(conf/)
	map_athena.conf nullpo_check追加
	(db/)
	item_db.txt 結婚指輪を武器-アクセサリに変更＆最新版
	(doc/)
	client_packet.txt 更新
	conf_ref.txt nullpo_check追加
	(common/)
	Makefile 変更
	nullpo.c 追加
	nullpo.h 追加
	(map/)
	Makefile 変更
	map.c
		map_config_read() nullpo_check追加
	map.h 同上
	skill.c NULLチェック総入れ替え
		skill_status_change_start() コンセントレーション修正
		skill_castend_nodamage_id() テレポート修正
	clif.c
		clif_skill_setunit() コメント修正
	pc.c
		pc_calcstatus() コンセントレーション修正

--------------------
//1016 by な。
・Athena雑談スレッドPart4 42 かる氏作のウンバラNPCを追加

	(script/npc/town/)
		npc_town_umbala.txt追加
			イベントデバッグ様(230〜256行目)はコメントアウト
	(conf/)
		map_athena.conf town に npc: script/npc/town/npc_town_umbala.txt 追加

--------------------
//1015 by (凸)
・リムーブトラップを本鯖仕様とAthena仕様で選べるようにした
・スパノビにAll+10する条件が良く分からなかったけど最初から+10じゃないのは確かなのでとりあえずBase99で一度も死んでなければという条件に変更
・ダンス中に吹き飛ばされてもエフェクトは移動しないそうなので変更
・@go 13微調整


	(conf/)
	battle_athena.conf skill_removetrap_type追加
	(doc/)
	client_packet.txt 本鯖相違スレッド part3 23 M ＠zqcM6jBwさんの情報を追加
	conf_ref.txt skill_removetrap_type追加
	(map/)
	atcommand.c
		atcommand_go() ウンバラの出現位置微調整
	battle.c
		battle_config_read() skill_removetrap_type追加
	battle.h 同上
	pc.c
		pc_calcstatus() スパノビAll+10条件変更
	skill.c
		skill_blown() ダンス中の吹き飛ばしを元に戻した
		skill_castend_nodamage_id() リムーブトラップ仕様変更

 --------------------
//1014 by (Pepermint)
I fixed again the problem if you put minus sign(-) in front of digits, 
the error comes up when you puchase a item.
When you put a minus sign(-), the error sign will be changed shrotage of 
amount as original server dose.

I tested with it in ver. 1013, it was working

--------------------
//1013 by (凸)
・サーバースナップショット

--------------------

//1012以前の変更点はReadmeを参照してください

--------------------

    Athena Dev. v2.1.1       Released: Middle July, 2003
    (c) 2003 Athena Project.
     http://project-yare.de/

1. Athena(アテナ)について
2. このリリースについて
3. 必要な物
4. 使い方
5. 現在の仕様
6. 祝辞
7. 免責事項
8. 募集
9. English


1. アテナについて
    アテナとは2003年1月半ばにでた0052.lzhをベースとして作られているエミュレータの一つです。
    基本的なライセンスはオリジナルがGPLの下に配布されている為、
    これに従いGPLの下配布を許可します。
    /*
        改良版を配布する場合は必ずこのREADMEを書き換えてください。
        何処を改良したのか報告(athena@project-yare.deまで)して貰えると助かります。
        バイナリのみの配布はGPL違反ですので"必ず"ソースも添付してください。
     */
    動作の確認は以下の通りのみ行っています。
    // ただし完璧に動く事を保証するものでありません
    対象CPU: Intel Pentium系   // PentiumII以上で確認.
        FreeBSD 4.8R, 4.6.2R
        Linux RedHat 7.3
        cygwin + gcc 3.2 20020927 (prerelease)
    開発元URL: http://project-yare.de/


2. このリリースについて
    今回のリリースは前回(V2.1)同様開発版のリリースのみです。
    2.1に比べ下記の点が修正されています。
        mapのデフォルト設定が韓国data.grfのみ正常に動作するようになっていた点
        common/timer.cやmap/script.cの幾つかのバグ

    迅速にUpdateを強く推奨するものではありませんが各自の判断で行って下さい。


3. 必要な物
    data.grf      //sdata.grfは必要に応じて
    account.txt   //存在しない場合athena.shが自動生成します
    conf/*.cnf    //Map用とChar用の二種類あります
    conf/npc*.txt //npc設定用ファイルです。複数のファイルに分けることが可能です。
    db/*.txt      //アイテム、job情報など


4. 使い方
    > tar xvfz athena-d?.?.tar.gz
    > cd athena-d?.?.tar.gz
    > make
    > vi conf/char_athena.cnf       //IP(127.0.0.1)の部分を環境に合わせて変更してください
    > vi conf/map_athena.cnf        //同上、またmap設定などは、このファイルで行います。
    > ./athena.sh
    上記を行えば"たぶん"起動します。

    補足:
    conf/npc_sampleJ.txtにはスクリプトの書き方について色々な説明が記載されています。
    もし、独自のMap設定を行ってみたい人や、スクリプトを弄りたい方は参考にしてください。
    ただし、開発中のためスクリプトの仕様が変更される可能性が高いです。
    command.txtには実装済みの特殊コマンドについての説明を記載しています。


5. 現在の仕様
    本鯖と比べておかしい(例えばプバが歩く、ポリンがアイテムを拾わないなど)点は、
    全て現在開発中に因るものです。
    現状としてキャラクタ系及びモンスター系のバグ報告は無視される可能性が高いです。

    バグ報告について必ず発生条件をお書き下さい。
    下にある報告用テンプレートを使って報告して頂くと助かります。
    報告先はエミュ板の開発スレにでも。
    ---- Athena v 2.0 (stable or develop) ----
    【gcc ver】gcc -vを実行時に表示される内容
    【動作システム】FreeBSD, Linux(ディストリビュージョンも), cygwinなど
    【発生内容】mapが落ちてしまった時の表示されていたデバッグ情報など具体的に書いてください。
    【操作内容】具体的にどんな操作を行ったかを書いてください。
    ------------------ END -------------------
    理想はテンプレに加えてmap.coreなどcoreファイルをUploaderにアップして頂くことですが
    問題のMapだけの状態にしcoreの吐く容量に注意してください。
    /*
        確認した限りでは324個ほどmapデータを読み込ませると、
         40MB近いcoreファイルを吐き出します @FreeBSD
         cygwinの場合はstackdumpというファイルになるそうです。
        しかし、coreファイルなどをgzip圧縮などすれば大幅に小さくなります。
         大凡30MBのcoreファイルが2.9MBほどになるようです。
        ですので、もしアップロードする場合はgzip圧縮など各自行ってください。
     */

    今回のリリースだけでなくHISTORYを作成すると大量に記述が必要な為省略しています。
    // 多い日だと本当に結構ありますので‥‥。


6. 祝辞
    今回このAthena開発版を出すに当たって感謝したい方々(順番不同)
        Lemming氏 (Project YARE)
        0052氏 (Uploader)
        35氏 (エミュ開発スレ)
        Johan Lindh氏(Author of memwatch)
        YARE forumのNPC情報を作成した方々
        weiss研究会BBSの様々な情報ファイルを作成した方々
        最後に、.coreファイル達


7. 免責事項
    Athena Projectは一切Athenaの動作に関する保証等は行いません。
    つまり、Athenaは無保証です。
    athena@project-yare.deに動作・操作等に関する質問などを送られても一切お答えできません。
    又Athenaを用いたことにより生じた被害・問題等の責任は一切Athena Projectは負いません。


8. 募集
    athenaの開発に参加したい//興味があるという方ご連絡下さい。
    我々は貴方の参加をお待ちしています。
    // 最新版が欲しいだけで何ら協力して頂けないという方はお断りです;-)
    [募集要項: プログラマ(2-3人)]
        年齢: 不問
        性別: 不問
        言語: 日本語が理解可能
        内容: C言語もしくはC++による開発。(特にネットワークやDBの経験が有る方大募集!)
    [募集要項: 翻訳(?人)]
        年齢: 不問
        性別: 不問
        言語: 日本語、英語が理解可能
        内容: 仏蘭西語、独逸語、西班牙語、伊太利亜語、泰(タイ)語、朝鮮語、中国語へ文献、サイトなどの翻訳
    連絡先: athena@project-yare.de 雑務担当まで。


9. English
     This release is just fixed some bugs in timer.c, script.c and map_athena1.conf.


(c) 2003 Athena Project.
